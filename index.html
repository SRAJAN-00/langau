<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>French Plurals (Pluriels) - Learning Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@400;700&family=DM+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Table of Contents Sidebar -->
    <aside class="toc-sidebar">
      <h2 class="toc-title">Table of Contents</h2>
      <ul class="toc-list">
        <li><a href="#intro">Introduction</a></li>
        <li><a href="#quick-examples">Quick Examples</a></li>
        <li><a href="#rule-1">Rule 1: Add -s</a></li>
        <li><a href="#rule-2">Rule 2: -s, -x, -z stay same</a></li>
        <li><a href="#rule-3">Rule 3: -eau, -au, -eu + x</a></li>
        <li><a href="#rule-4">Rule 4: -al ‚Üí -aux</a></li>
        <li><a href="#rule-5">Rule 5: Irregular plurals</a></li>
        <li><a href="#listening-practice">Listening Practice</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <button class="theme-toggle" id="themeToggle" title="Toggle reading mode">
        <i class="fas fa-adjust"></i>
      </button>
      <div class="container">
        <header>
          <h1>üá´üá∑ French Plurals (Pluriels)</h1>
          <p class="subtitle">Master the art of making French nouns plural</p>
        </header>

        <section id="intro" class="intro-section">
          <div class="info-box">
            <h2>Introduction</h2>
            <p>
              In English, making plurals is usually very simple. Most of the
              time, you just add an -s, like <em>cat</em> becoming
              <em>cats</em>.
            </p>
            <p>
              In French, most nouns also form the plural by adding an -s, but
              there are a few important things to notice. The pronunciation
              often does not change. For example, <strong>chat</strong> and
              <strong>chats</strong> sound the same. This means you often
              <em>see</em> the plural more than you <em>hear</em> it.
            </p>
            <p>
              You also need to remember to change the article when a noun
              becomes plural:
            </p>
            <ul>
              <li>
                <strong>un chat</strong>
                <strong>des chats</strong>
              </li>
              <li>
                <strong>la table</strong>
                <strong>les tables</strong>
              </li>
            </ul>
            <p class="highlight">
              So, in French, plural forms are mostly about spelling and using
              the correct article, not always about how the word sounds. Paying
              attention to these small letters is very important in French.
            </p>
          </div>
        </section>

        <section id="quick-examples" class="examples-section">
          <h2>Quick Examples</h2>
          <div class="table-responsive">
            <table class="examples-table">
              <thead>
                <tr class="col-header">
                  <th>French Singular</th>
                  <th>French Plural</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <span class="french-word">un chat</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('un chat')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des chats</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des chats')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">une pomme</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('une pomme')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des pommes</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des pommes')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">le livre</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('le livre')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les livres</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les livres')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">la table</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('la table')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les tables</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les tables')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">un cheval</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('un cheval')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des chevaux</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des chevaux')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">la maison</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('la maison')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les maisons</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les maisons')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <div id="rule-1" class="rule-section active">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 1</span> Most nouns form the plural
              by adding "-s"
            </h3>
            <p class="rule-description">
              Just add <strong>‚Äìs</strong> to the end of the word.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>French Singular</th>
                    <th>French Plural</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">un chat</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('un chat')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">des chats</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('des chats')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">une pomme</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('une pomme')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">des pommes</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('des pommes')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">le livre</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('le livre')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">les livres</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('les livres')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">la table</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('la table')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">les tables</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('les tables')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>üí° Key Points</h4>
              <p>
                See those <strong>"les"</strong> and
                <strong>"des"</strong> popping up everywhere? It's simple. When
                a noun becomes plural, <em>le</em> and <em>la</em> change to
                <strong>les</strong>, and <em>un</em> and <em>une</em> become
                <strong>des</strong>. That's all there is to it.
              </p>
              <p>
                Your definite and indefinite articles have simply become plural.
              </p>
            </div>

            <div class="info-box note-box">
              <h4>üìù Note: Liaison</h4>
              <p>
                The final <strong>-s</strong> in plural nouns is usually silent
                when speaking. However, when a plural word ending in a silent -s
                is followed by a word that begins with a vowel (a, e, i, o, u,
                y) or a silent "h", a sound link can happen. This is called
                <strong>liaison</strong>.
              </p>
              <p>
                In liaison, the silent -s is pronounced like a
                <strong>z</strong> sound to connect the words smoothly.
              </p>
              <ul>
                <li>
                  <strong>Les</strong> = "lay" ‚Üí with liaison: "lay-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Les amis')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
                <li>
                  <strong>Mes</strong> = "may" ‚Üí with liaison: "may-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Mes enfants')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
                <li>
                  <strong>Des</strong> = "day" ‚Üí with liaison: "day-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Des id√©es')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
              </ul>

              <div class="table-responsive">
                <table class="liaison-table">
                  <thead>
                    <tr>
                      <th>Singular Form</th>
                      <th>Plural Phrase (with liaison)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>L'ami</td>
                      <td>
                        <span class="french-word">Les amis</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les amis')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Mon enfant</td>
                      <td>
                        <span class="french-word">Mes enfants</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Mes enfants')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Une id√©e</td>
                      <td>
                        <span class="french-word">Des id√©es</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Des id√©es')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Le village</td>
                      <td>
                        <span class="french-word">Les villages</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les villages')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Le chapeau</td>
                      <td>
                        <span class="french-word">Les chapeaux</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les chapeaux')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div id="rule-2" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 2</span> Nouns ending in -s, -x, or
              -z stay the same
            </h3>
            <p class="rule-description">
              No change in spelling; they already look plural.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un choix</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un choix')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des choix</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des choix')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un nez</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un nez')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des nez</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des nez')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un fils</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un fils')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des fils</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des fils')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>üí° Remember</h4>
              <p>
                Only the article shows the plural form. The noun itself remains
                unchanged!
              </p>
            </div>
          </div>
        </div>

        <div id="rule-3" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 3</span> Nouns ending in -eau, -au,
              or -eu add "x"
            </h3>
            <p class="rule-description">
              Add <strong>‚Äìx</strong> instead of ‚Äìs.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un tableau</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un tableau')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des tableaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des tableaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un g√¢teau</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un g√¢teau')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des g√¢teaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des g√¢teaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un jeu</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un jeu')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des jeux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des jeux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box exception-box">
              <h4>‚ö†Ô∏è Exceptions</h4>
              <p>Some nouns just add -s instead:</p>
              <ul>
                <li><strong>bleu</strong> ‚Üí <strong>bleus</strong></li>
                <li><strong>pneu</strong> ‚Üí <strong>pneus</strong></li>
              </ul>
            </div>
          </div>
        </div>

        <div id="rule-4" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 4</span> Nouns ending in -al change
              to -aux
            </h3>
            <p class="rule-description">
              Replace <strong>-al</strong> with <strong>-aux</strong>.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un animal</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un animal')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des animaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des animaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un journal</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un journal')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des journaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des journaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box exception-box">
              <h4>‚ö†Ô∏è Exceptions</h4>
              <p>Some nouns just add -s:</p>
              <ul>
                <li>
                  <strong>un festival</strong> ‚Üí <strong>des festivals</strong>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div id="rule-5" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 5</span> Seven nouns ending in -ou
              change to -oux
            </h3>
            <p class="rule-description">
              Most other -ou nouns just take a regular -s in plural. These are
              the
              <strong>7 exceptions</strong> in French where -ou becomes -oux in
              the plural.
            </p>

            <div class="table-responsive">
              <table class="rule-table special-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Meaning</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un bijou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un bijou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a jewel / jewellery</td>
                    <td>
                      <span class="french-word">Des bijoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des bijoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un caillou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un caillou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a pebble</td>
                    <td>
                      <span class="french-word">Des cailloux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des cailloux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un chou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un chou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a cabbage</td>
                    <td>
                      <span class="french-word">Des choux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des choux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un genou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un genou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a knee</td>
                    <td>
                      <span class="french-word">Des genoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des genoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un hibou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un hibou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>an owl</td>
                    <td>
                      <span class="french-word">Des hiboux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des hiboux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un joujou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un joujou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a toy</td>
                    <td>
                      <span class="french-word">Des joujoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des joujoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un pou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un pou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a louse</td>
                    <td>
                      <span class="french-word">Des poux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des poux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>üí° Memory Tip</h4>
              <p>
                Remember these 7 special words! All other -ou words just add a
                regular -s.
              </p>
            </div>
          </div>
        </div>

        <section class="summary-section">
          <h2>Summary of All Rules</h2>
          <div class="table-responsive">
            <table class="summary-table">
              <thead>
                <tr>
                  <th>Rule</th>
                  <th>Main Idea</th>
                  <th>Examples</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Rule 1</strong></td>
                  <td>Most nouns form the plural by adding -s</td>
                  <td>chat ‚Üí chats<br />pomme ‚Üí pommes<br />livre ‚Üí livres</td>
                  <td>
                    The final -s is silent. Articles change to <em>les</em> and
                    <em>des</em>. Liaison appears before vowels.
                  </td>
                </tr>
                <tr>
                  <td><strong>Rule 2</strong></td>
                  <td>Nouns ending in -s, -x, or -z do not change</td>
                  <td>choix ‚Üí choix<br />nez ‚Üí nez<br />fils ‚Üí fils</td>
                  <td>Only the article shows the plural form.</td>
                </tr>
                <tr>
                  <td><strong>Rule 3</strong></td>
                  <td>Nouns ending in -eau, -au, or -eu add -x</td>
                  <td>
                    tableau ‚Üí tableaux<br />g√¢teau ‚Üí g√¢teaux<br />jeu ‚Üí jeux
                  </td>
                  <td>The -x is silent. A few exceptions add -s.</td>
                </tr>
                <tr>
                  <td><strong>Rule 4</strong></td>
                  <td>Nouns ending in -al change to -aux</td>
                  <td>animal ‚Üí animaux<br />journal ‚Üí journaux</td>
                  <td>Some exceptions add -s, such as festival ‚Üí festivals.</td>
                </tr>
                <tr>
                  <td><strong>Rule 5</strong></td>
                  <td>Seven nouns ending in -ou change to -oux</td>
                  <td>bijou ‚Üí bijoux<br />chou ‚Üí choux<br />genou ‚Üí genoux</td>
                  <td>Most other -ou nouns take a regular -s.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="agreement-section">
          <div class="info-box">
            <h2>What Else Changes with Plural Nouns?</h2>
            <p>
              For now, just remember this: in French, when a noun is plural,
              some other words linked to it are usually plural too. These
              include articles (like <em>les</em>), adjectives (like
              <em>grands</em>), verbs (like <em>jouent</em>), demonstratives
              (like <em>ces</em>), and possessives (like <em>mes</em>).
            </p>

            <div class="table-responsive">
              <table class="agreement-table">
                <thead>
                  <tr>
                    <th>Element</th>
                    <th>French</th>
                    <th>English Translation</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Definite article</td>
                    <td>les chats</td>
                    <td>the cats</td>
                  </tr>
                  <tr>
                    <td>Indefinite article</td>
                    <td>des livres</td>
                    <td>(some) books</td>
                  </tr>
                  <tr>
                    <td>Partitive article</td>
                    <td>des fruits</td>
                    <td>(some) fruits</td>
                  </tr>
                  <tr>
                    <td>Adjective</td>
                    <td>grandes maisons</td>
                    <td>big houses</td>
                  </tr>
                  <tr>
                    <td>Verb (subject-verb)</td>
                    <td>les enfants jouent</td>
                    <td>the children are playing</td>
                  </tr>
                  <tr>
                    <td>Demonstrative adjective</td>
                    <td>ces chaises</td>
                    <td>these chairs</td>
                  </tr>
                  <tr>
                    <td>Possessive adjective</td>
                    <td>ses amis</td>
                    <td>his/her friends</td>
                  </tr>
                  <tr>
                    <td>Pronoun (subject or obj)</td>
                    <td>ils parlent, je les vois</td>
                    <td>they are speaking, I see them</td>
                  </tr>
                  <tr>
                    <td>√† / de contractions</td>
                    <td>aux filles, des gar√ßons</td>
                    <td>to the girls, (some) boys</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <p class="note-text">
              You do not need to master all of this right now. You will learn
              these rules step by step as you continue learning French. This
              note is only to keep you informed so you know what is coming
              later.
            </p>
          </div>
        </section>

        <!-- Audio Story Section -->
        <section id="listening-practice" class="listening-section">
          <div class="listening-card">
            <div class="listening-content">
              <div class="audio-header">
                <button class="main-play-btn" id="mainPlayBtn">
                  <i class="fas fa-play"></i>
                </button>
                <div class="audio-info">
                  <span class="speed-display">1.0x</span>
                  <div class="progress-bar">
                    <div class="progress-fill"></div>
                  </div>
                  <button class="refresh-btn" id="refreshBtn">
                    <i class="fas fa-redo"></i>
                  </button>
                </div>
              </div>

              <h3 class="story-title">Deux caf√© S'il-vous pla√Æt</h3>

              <div class="story-text-box" id="storyTextBox">
                <p class="story-sentence" data-index="0" data-translation="This morning, I walk on this calm street and I look around me.">
                  <strong class="french-sentence"
                    >Ce matin, je marche dans cette rue calme et je regarde
                    autour de moi.</strong
                  >
                </p>

                <p class="story-sentence" data-index="1" data-translation="Near the caf√©, I see this man with a smile and he speaks softly.">
                  <strong class="french-sentence"
                    >Pr√®s du caf√©, je vois cet homme avec un sourire et il parle
                    doucement.</strong
                  >
                </p>

                <p class="story-sentence" data-index="2" data-translation="This man reads this book while he drinks a coffee.">
                  <strong class="french-sentence"
                    >Cet homme lit ce livre-ci pendant qu'il boit un
                    caf√©.</strong
                  >
                </p>

                <p class="story-sentence" data-index="3" data-translation="A little further, these children play in that park and laugh together.">
                  <strong class="french-sentence"
                    >Un peu plus loin, ces enfants jouent dans le parc-l√† et
                    rient ensemble.</strong
                  >
                </p>

                <p class="story-sentence" data-index="4" data-translation="This simple scene makes me calm and happy.">
                  <strong class="french-sentence"
                    >Cette sc√®ne simple me rend calme et heureux.</strong
                  >
                </p>
              </div>

              <div class="listening-controls">
                <button class="play-story-btn" id="playStoryBtn">
                  <i class="fas fa-play"></i> Play Story
                </button>
                <button
                  class="pause-story-btn"
                  id="pauseStoryBtn"
                  style="display: none"
                >
                  <i class="fas fa-pause"></i> Pause
                </button>
                <select id="speedControl" class="speed-selector">
                  <option value="0.6">Slow</option>
                  <option value="0.8" selected>Normal</option>
                  <option value="1.0">Fast</option>
                </select>
              </div>
            </div>

            <div class="listening-image">
              <img
                src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=800&auto=format&fit=crop&q=80"
                alt="Cafe terrace with coffee and food"
              />
            </div>
          </div>
        </section>
      </div>
    </div>
    <!-- End Main Content -->

    <script>
      // Story audio player variables
      let storySentences = [];
      let storyUtterance = null;
      let isPlaying = false;
      let currentSentenceIndex = 0;
      let letterTimer = null;

      // Word translations dictionary
      const wordTranslations = {
        "ce": "this",
        "matin": "morning",
        "je": "I",
        "marche": "walk",
        "dans": "in",
        "cette": "this",
        "rue": "street",
        "calme": "calm",
        "et": "and",
        "regarde": "look",
        "autour": "around",
        "de": "of",
        "moi": "me",
        "pr√®s": "near",
        "du": "of the",
        "caf√©": "caf√©",
        "vois": "see",
        "cet": "this",
        "homme": "man",
        "avec": "with",
        "un": "a",
        "sourire": "smile",
        "il": "he",
        "parle": "speaks",
        "doucement": "softly",
        "lit": "reads",
        "livre-ci": "book",
        "pendant": "while",
        "qu'il": "that he",
        "boit": "drinks",
        "peu": "little",
        "plus": "more",
        "loin": "far",
        "ces": "these",
        "enfants": "children",
        "jouent": "play",
        "le": "the",
        "parc-l√†": "park",
        "rient": "laugh",
        "ensemble": "together",
        "sc√®ne": "scene",
        "simple": "simple",
        "me": "me",
        "rend": "makes",
        "heureux": "happy"
      };

      function normalizeSentence(text) {
        return text.replace(/\s+/g, " ").trim();
      }

      function getWordTranslation(word) {
        const cleanWord = word.toLowerCase().replace(/[.,!?;:]/g, "");
        return wordTranslations[cleanWord] || "";
      }

      function buildWordLetterSpans(sentenceEl) {
        const rawText = normalizeSentence(sentenceEl.textContent);
        const fragment = document.createDocumentFragment();
        const tokens = rawText.split(/(\s+)/);
        let offset = 0;

        tokens.forEach((token) => {
          if (token === "") {
            return;
          }

          if (/^\s+$/.test(token)) {
            fragment.appendChild(document.createTextNode(token));
            offset += token.length;
            return;
          }

          const wordSpan = document.createElement("span");
          wordSpan.className = "word";
          wordSpan.dataset.start = offset;
          wordSpan.dataset.end = offset + token.length;
          
          // Add translation to word
          const translation = getWordTranslation(token);
          if (translation) {
            wordSpan.dataset.translation = translation;
          }

          Array.from(token).forEach((char, index) => {
            const letterSpan = document.createElement("span");
            letterSpan.className = "letter";
            letterSpan.textContent = char;
            letterSpan.dataset.index = offset + index;
            wordSpan.appendChild(letterSpan);
          });

          fragment.appendChild(wordSpan);
          offset += token.length;
        });

        sentenceEl.textContent = "";
        sentenceEl.appendChild(fragment);
        sentenceEl.dataset.text = rawText;
      }

      // Highlight sentence
      function highlightSentence(index) {
        // Remove all active classes
        document.querySelectorAll(".story-sentence").forEach((el) => {
          el.classList.remove("active");
        });

        // Add active class to current sentence
        const sentence = document.querySelector(
          `.story-sentence[data-index="${index}"]`,
        );
        if (sentence) {
          sentence.classList.add("active");
          sentence.scrollIntoView({ behavior: "smooth", block: "nearest" });
        }
      }

      // Clear all highlights
      function clearHighlights() {
        document.querySelectorAll(".story-sentence").forEach((el) => {
          el.classList.remove("active");
        });

        document
          .querySelectorAll(".french-sentence .letter")
          .forEach((letter) => letter.classList.remove("letter-active"));

        document
          .querySelectorAll(".french-sentence .word")
          .forEach((word) => {
            word.classList.remove("word-active");
            word.classList.remove("word-speaking");
          });

        if (letterTimer) {
          clearInterval(letterTimer);
          letterTimer = null;
        }
      }

      function highlightLettersInWord(wordEl, rate) {
        if (!wordEl) {
          return;
        }

        if (letterTimer) {
          clearInterval(letterTimer);
          letterTimer = null;
        }

        const letters = Array.from(wordEl.querySelectorAll(".letter"));
        letters.forEach((letter) => letter.classList.remove("letter-active"));

        if (letters.length === 0) {
          return;
        }

        let index = 0;
        const baseCharsPerSecond = 12;
        const interval = Math.max(40, 1000 / (baseCharsPerSecond * rate));

        // Add word-speaking class when starting
        wordEl.classList.add("word-speaking");
        letters[0].classList.add("letter-active");

        letterTimer = setInterval(() => {
          if (index >= letters.length - 1) {
            clearInterval(letterTimer);
            letterTimer = null;
            // Keep word-speaking class - it will be removed when next word starts
            return;
          }
          index += 1;
          letters[index - 1].classList.remove("letter-active");
          letters[index].classList.add("letter-active");
        }, interval);
      }

      function highlightWordAtIndex(sentenceEl, charIndex, rate) {
        if (!sentenceEl) {
          console.log("No sentence element");
          return;
        }

        const words = Array.from(sentenceEl.querySelectorAll(".word"));
        console.log("Found words:", words.length, "charIndex:", charIndex);
        
        // Remove all previous word highlighting
        words.forEach((word) => {
          word.classList.remove("word-active");
          word.classList.remove("word-speaking");
        });

        const activeWord = words.find((word) => {
          const start = Number(word.dataset.start);
          const end = Number(word.dataset.end);
          return charIndex >= start && charIndex < end;
        });

        if (activeWord) {
          console.log("Highlighting word:", activeWord.textContent);
          activeWord.classList.add("word-active");
          highlightLettersInWord(activeWord, rate);
        } else {
          console.log("No active word found for charIndex:", charIndex);
        }
      }

      // Play story function with highlighting
      function playStory() {
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const speedControl = document.getElementById("speedControl");

        if (isPlaying) {
          // Pause
          window.speechSynthesis.pause();
          isPlaying = false;
          mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        } else if (window.speechSynthesis.paused && storyUtterance) {
          // Resume
          window.speechSynthesis.resume();
          isPlaying = true;
          mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
        } else {
          // Start new - play sentence by sentence
          window.speechSynthesis.cancel();
          currentSentenceIndex = 0;
          playSentence(0);
          isPlaying = true;
          mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
        }
      }

      // Play individual sentence with highlighting
      function playSentence(index) {
        if (index >= storySentences.length) {
          // Finished all sentences
          isPlaying = false;
          const mainPlayBtn = document.getElementById("mainPlayBtn");
          if (mainPlayBtn) {
            mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
          }
          clearHighlights();
          return;
        }

        highlightSentence(index);

        const sentenceElement = document.querySelector(
          `.story-sentence[data-index="${index}"] .french-sentence`,
        );
        const utterance = new SpeechSynthesisUtterance(storySentences[index]);
        const speedControl = document.getElementById("speedControl");
        const rate = parseFloat(speedControl ? speedControl.value : 0.8);
        utterance.lang = "fr-FR";
        utterance.rate = rate;
        utterance.pitch = 1;
        utterance.volume = 1;

        // Time-based word highlighting
        const words = Array.from(sentenceElement.querySelectorAll(".word"));
        const text = storySentences[index];
        const avgCharsPerSecond = 12 * rate;
        let currentWordIndex = 0;

        utterance.onstart = function() {
          if (words.length > 0) {
            words[0].classList.add("word-speaking");
            highlightLettersInWord(words[0], rate);
            
            const wordInterval = setInterval(() => {
              if (currentWordIndex < words.length - 1 && isPlaying) {
                words[currentWordIndex].classList.remove("word-speaking");
                currentWordIndex++;
                words[currentWordIndex].classList.add("word-speaking");
                highlightLettersInWord(words[currentWordIndex], rate);
              } else {
                clearInterval(wordInterval);
              }
            }, 400 / rate);
            
            utterance.wordInterval = wordInterval;
          }
        };

        utterance.onend = function () {
          if (utterance.wordInterval) {
            clearInterval(utterance.wordInterval);
          }
          if (sentenceElement) {
            sentenceElement
              .querySelectorAll(".letter")
              .forEach((letter) => letter.classList.remove("letter-active"));
            sentenceElement
              .querySelectorAll(".word")
              .forEach((word) => {
                word.classList.remove("word-active");
                word.classList.remove("word-speaking");
              });
          }
          if (isPlaying) {
            // Play next sentence
            currentSentenceIndex++;
            setTimeout(() => playSentence(currentSentenceIndex), 500);
          }
        };

        window.speechSynthesis.speak(utterance);
      }

      // Refresh/Stop story function
      function refreshStory() {
        window.speechSynthesis.cancel();
        isPlaying = false;
        currentSentenceIndex = 0;
        clearHighlights();
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        if (mainPlayBtn) {
          mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        }
      }

      // Theme Toggle Function
      function toggleTheme() {
        const body = document.body;
        const currentTheme = localStorage.getItem("theme") || "warm";

        // Remove all theme classes first
        body.classList.remove("light-mode", "dark-mode");

        // Cycle through themes: warm ‚Üí light ‚Üí dark ‚Üí warm
        if (currentTheme === "warm") {
          body.classList.add("light-mode");
          localStorage.setItem("theme", "light");
        } else if (currentTheme === "light") {
          body.classList.add("dark-mode");
          localStorage.setItem("theme", "dark");
        } else {
          // dark mode, go back to warm
          localStorage.setItem("theme", "warm");
        }
      }

      // Rule navigation function
      function showRule(ruleNumber) {
        // Hide all rule sections
        const allRules = document.uickuerySelectorAll(".rule-section");
        allRules.forEach((rule) => {
          rule.classList.remove("active");
        });

        // Show the selected rule
        const selectedRule = document.getElementById(`rule-${ruleNumber}`);
        if (selectedRule) {
          selectedRule.classList.add("active");
          selectedRule.scrollIntoView({ behavior: "smooth", block: "start" });
        }

        // Update button states
        const allButtons = document.querySelectorAll(".rule-btn");
        allButtons.forEach((btn, index) => {
          if (index + 1 === ruleNumber) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
      }

      // Text-to-Speech function for French words
      function speakFrench(text) {
        // Cancel any ongoing speech
        window.speechSynthesis.cancel();

        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = "fr-FR"; // French language
        utterance.rate = 0.8; // Slightly slower for learning
        utterance.pitch = 1;
        utterance.volume = 1;

        // Try to use a French voice if available
        const voices = window.speechSynthesis.getVoices();
        const frenchVoice = voices.find((voice) => voice.lang.startsWith("fr"));
        if (frenchVoice) {
          utterance.voice = frenchVoice;
        }

        window.speechSynthesis.speak(utterance);
      }

      // Load voices (some browsers need this)
      window.speechSynthesis.onvoiceschanged = function () {
        window.speechSynthesis.getVoices();
      };

      // Translation dictionary for French to English
      const translations = {
        "un chat": "a cat",
        "des chats": "cats",
        "une pomme": "an apple",
        "des pommes": "apples",
        "le livre": "the book",
        "les livres": "the books",
        "la table": "the table",
        "les tables": "the tables",
        "un cheval": "a horse",
        "des chevaux": "horses",
        "la maison": "the house",
        "les maisons": "the houses",
        "un choix": "a choice",
        "des choix": "choices",
        "un nez": "a nose",
        "des nez": "noses",
        "un fils": "a son",
        "des fils": "sons",
        "un tableau": "a painting/board",
        "des tableaux": "paintings/boards",
        "un g√¢teau": "a cake",
        "des g√¢teaux": "cakes",
        "un jeu": "a game",
        "des jeux": "games",
        "un animal": "an animal",
        "des animaux": "animals",
        "un journal": "a newspaper",
        "des journaux": "newspapers",
        "un bijou": "a jewel",
        "des bijoux": "jewels",
        "un caillou": "a pebble",
        "des cailloux": "pebbles",
        "un chou": "a cabbage",
        "des choux": "cabbages",
        "un genou": "a knee",
        "des genoux": "knees",
        "un hibou": "an owl",
        "des hiboux": "owls",
        "un joujou": "a toy",
        "des joujoux": "toys",
        "un pou": "a louse",
        "des poux": "lice",
        "les chats": "the cats",
        "des livres": "(some) books",
        "des fruits": "(some) fruits",
        "grandes maisons": "big houses",
        "les enfants jouent": "the children are playing",
        "ces chaises": "these chairs",
        "ses amis": "his/her friends",
        "ils parlent": "they are speaking",
        "je les vois": "I see them",
        "aux filles": "to the girls",
        "des gar√ßons": "(some) boys",
        "L'ami": "the friend",
        "Les amis": "the friends",
        "Mon enfant": "my child",
        "Mes enfants": "my children",
        "Une id√©e": "an idea",
        "Des id√©es": "(some) ideas",
        "Le village": "the village",
        "Les villages": "the villages",
        "Le chapeau": "the hat",
        "Les chapeaux": "the hats",
        "un festival": "a festival",
        "des festivals": "festivals",
        bleu: "blue",
        bleus: "blues",
        pneu: "tire",
        pneus: "tires",
      };

      // Initialize: Show the first rule by default

      // Add keyboard navigation

      // Add hover effects to table rows

      // Function to update progress bar (optional enhancement)
      function updateProgressBar(percentage) {
        // This can be used to add a progress indicator at the top of the page
        // For now, it's a placeholder for future enhancement
        console.log(`Scroll progress: ${percentage.toFixed(2)}%`);
      }

      // Function to highlight search terms (optional enhancement)
      function highlightText(searchTerm) {
        const content = document.querySelector(".container");
        const innerHTML = content.innerHTML;
        const searchRegex = new RegExp(searchTerm, "gi");

        if (searchTerm.length > 2) {
          const newHTML = innerHTML.replace(
            searchRegex,
            (match) => `<mark>${match}</mark>`,
          );
          content.innerHTML = newHTML;
        }
      }

      // Add print functionality
      function printPage() {
        window.print();
      }

      // Export to PDF functionality (requires additional library in production)
      function exportToPDF() {
        alert(
          "PDF export feature coming soon! For now, you can use your browser's print function to save as PDF.",
        );
        window.print();
      }

      // Toggle dark mode (optional enhancement for future)
      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "darkMode",
          document.body.classList.contains("dark-mode"),
        );
      }

      // Load dark mode preference
      if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
      }

      // Add translation tooltips to French text
      function addTranslationTooltips() {
        // Find all french-word spans first
        const frenchWordSpans = document.querySelectorAll(".french-word");

        frenchWordSpans.forEach((span) => {
          const text = span.textContent.trim();

          // Check if the text exists in our translations (case-insensitive)
          const translationKey = Object.keys(translations).find(
            (key) => key.toLowerCase() === text.toLowerCase(),
          );

          if (translationKey) {
            // Add hover attributes and class
            span.classList.add("french-text");
            span.setAttribute("data-translation", translations[translationKey]);

            // Create tooltip element
            const tooltip = document.createElement("span");
            tooltip.className = "tooltip";
            tooltip.textContent = translations[translationKey];
            span.appendChild(tooltip);
          }
        });

        // Find all table cells (for tables without french-word spans)
        const tableCells = document.querySelectorAll("td");

        tableCells.forEach((cell) => {
          // Skip cells that have audio buttons or already processed french-word spans
          if (
            cell.querySelector(".audio-btn-inline") ||
            cell.querySelector(".french-word")
          ) {
            return;
          }

          const text = cell.textContent.trim();

          // Check if the text exists in our translations (case-insensitive)
          const translationKey = Object.keys(translations).find(
            (key) => key.toLowerCase() === text.toLowerCase(),
          );

          if (translationKey) {
            // Add hover attributes and class
            cell.classList.add("french-text");
            cell.setAttribute("data-translation", translations[translationKey]);

            // Create tooltip element
            const tooltip = document.createElement("span");
            tooltip.className = "tooltip";
            tooltip.textContent = translations[translationKey];
            cell.appendChild(tooltip);
          }
        });

        // Also add to inline French text in paragraphs and lists
        const textElements = document.querySelectorAll("p, li");
        textElements.forEach((element) => {
          let html = element.innerHTML;

          // Look for French text in <strong> or <em> tags
          Object.keys(translations).forEach((french) => {
            const regex = new RegExp(
              `<(strong|em)>\\s*${escapeRegex(french)}\\s*<\/(strong|em)>`,
              "gi",
            );
            const match = html.match(regex);

            if (match) {
              const replacement = `<$1 class="french-text" data-translation="${translations[french]}">${french}<span class="tooltip">${translations[french]}</span></$1>`;
              html = html.replace(regex, replacement);
            }
          });

          element.innerHTML = html;
        });
      }

      // Escape special characters for regex
      function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      }

      // Initialize page on load
      document.addEventListener("DOMContentLoaded", function () {
        // Prepare story text for word-level highlighting
        const storySentenceEls = document.querySelectorAll(
          ".story-sentence .french-sentence",
        );
        storySentences = Array.from(storySentenceEls).map((el) => {
          const normalized = normalizeSentence(el.textContent);
          el.textContent = normalized;
          buildWordLetterSpans(el);
          return normalized;
        });

        // Add translation tooltips
        addTranslationTooltips();

        // Set first rule button as active
        const firstButton = document.querySelector(".rule-btn");
        if (firstButton) {
          firstButton.classList.add("active");
        }

        // Load saved theme
        const savedTheme = localStorage.getItem("theme") || "warm";
        if (savedTheme === "light") {
          document.body.classList.add("light-mode");
        } else if (savedTheme === "dark") {
          document.body.classList.add("dark-mode");
        }

        // Add theme toggle button listener
        const themeToggle = document.getElementById("themeToggle");
        if (themeToggle) {
          themeToggle.addEventListener("click", toggleTheme);
        }

        // Add story audio player listeners
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const refreshBtn = document.getElementById("refreshBtn");

        if (mainPlayBtn) {
          mainPlayBtn.addEventListener("click", playStory);
        }

        if (refreshBtn) {
          refreshBtn.addEventListener("click", refreshStory);
        }

        // Update speed when changed
        const speedControl = document.getElementById("speedControl");
        if (speedControl) {
          speedControl.addEventListener("change", function () {
            if (isPlaying) {
              refreshStory();
            }
          });
        }
      });
    </script>
  </body>
</html>
