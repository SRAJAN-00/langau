<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>French Plurals (Pluriels) - Learning Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@400;700&family=DM+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      :root {
        /* Original warm color scheme */
        --primary-color: #2563eb;
        --accent-color: #3b82f6;
        --text-primary: #3d2817;
        --text-secondary: #363639;
        --text-tertiary: #9ca3af;
        --text-marron: #5b342e;
        --bg-primary: #f9f5f0;
        --bg-secondary: #f3ede6;
        --bg-card: #ffffff;
        --border-color: #e5e7eb;
        --hover-bg: #f9fafb;
        --bg-neutral: #f9fafb;

        /* mamproved shadows */
        --border-radius: 16px;
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
        --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);

        --header-color: #ffa90a;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "DM Sans",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          sans-serif;
        line-height: 1.7;
        color: var(--text-primary);
        background: var(--bg-primary);
        min-height: 100vh;
        padding: 0;
        font-weight: 400;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        overflow-x: hidden;
        display: flex;
      }

      /* Table of Contents Sidebar */
      .toc-sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: 280px;
        height: 100vh;
        background: var(--bg-primary);
        border-right: 1px solid #e8dfd6;
        overflow-y: auto;
        padding: 20px;
        z-index: 100;
        box-shadow: 2px 0 8px rgba(0, 0, 0, 0.03);
      }

      .toc-sidebar::-webkit-scrollbar {
        width: 6px;
      }

      .toc-sidebar::-webkit-scrollbar-track {
        background: transparent;
      }

      .toc-sidebar::-webkit-scrollbar-thumb {
        background: #d0d0d0;
        border-radius: 3px;
      }

      .toc-sidebar::-webkit-scrollbar-thumb:hover {
        background: #b0b0b0;
      }

      .toc-title {
        font-size: 0.9rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 16px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        padding-left: 12px;
      }

      .toc-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .toc-list li {
        margin-bottom: 4px;
      }

      .toc-list a {
        color: #1f2937;
        text-decoration: none;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: 8px;
        transition: all 0.2s ease;
        line-height: 1.4;
        border-left: 3px solid transparent;
        font-weight: 500;
      }

      .toc-list a i {
        font-size: 0.85rem;
        width: 18px;
        text-align: center;
        opacity: 0.7;
      }

      .toc-list a:hover {
        background: transparent;
        color: var(--text-primary);
        border-left-color: transparent;
      }

      .toc-list a:hover i {
        opacity: 1;
      }

      .toc-list a.active {
        background: #f8fafc;
        color: var(--text-primary);
        font-weight: 600;
        border-left-color: #cbd5f5;
      }

      .toc-list a.active i {
        opacity: 1;
      }

      /* Right Sidebar */
      .right-sidebar {
        position: fixed;
        right: 0;
        top: 0;
        width: 280px;
        height: 100vh;
        background: var(--bg-primary);
        border-left: 1px solid #e8dfd6;
        overflow-y: auto;
        padding: 40px 24px;
        z-index: 100;
        box-shadow: -2px 0 8px rgba(0, 0, 0, 0.03);
      }

      .right-sidebar::-webkit-scrollbar {
        width: 6px;
      }

      .right-sidebar::-webkit-scrollbar-track {
        background: transparent;
      }

      .right-sidebar::-webkit-scrollbar-thumb {
        background: #d0d0d0;
        border-radius: 3px;
      }

      .right-sidebar::-webkit-scrollbar-thumb:hover {
        background: #b0b0b0;
      }

      .sidebar-section {
        margin-bottom: 32px;
      }

      .sidebar-section h3 {
        font-size: 0.85rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 12px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      .sidebar-section p {
        font-size: 0.875rem;
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 8px;
      }

      .sidebar-section ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .sidebar-section li {
        font-size: 0.875rem;
        color: var(--text-secondary);
        padding: 8px 12px;
        margin-bottom: 6px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 6px;
        border-left: 3px solid var(--primary-color);
      }

      .sidebar-section.build-topics {
        margin-top: 32px;
        padding-top: 24px;
        border-top: 1px solid rgba(212, 165, 116, 0.2);
      }

      .sidebar-section.build-topics h3 {
        margin-bottom: 16px;
        padding-left: 12px;
      }

      .sidebar-section.build-topics ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .sidebar-section.build-topics li {
        margin-bottom: 8px;
        padding: 0;
        background: none;
        border: none;
      }

      .sidebar-section.build-topics a {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        text-decoration: none;
        font-size: 0.8rem;
        color: #4b5563;
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 6px;
        transition: all 0.2s ease;
        line-height: 1.4;
      }

      .sidebar-section.build-topics a:hover {
        background: rgba(255, 255, 255, 0.9);
        transform: translateX(2px);
      }

      .sidebar-section.build-topics a span {
        flex: 1;
      }

      .sidebar-section.build-topics a i {
        font-size: 0.7rem;
        opacity: 0.4;
        margin-left: 8px;
        margin-top: 2px;
      }

      .tip-badge {
        display: inline-block;
        background: #fef3c7;
        color: #92400e;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-bottom: 8px;
      }

      /* Main Content Area */
      .main-content {
        margin-left: 280px;

        flex: 1;
        min-height: 100vh;
      }

      .container {
        margin: 0 auto;
        background: transparent;

        max-width: 100%;
      }

      header {
        padding: 60px 60px 40px;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
        background: var(--bg-primary);
        position: relative;
        margin-bottom: 40px;
      }

      header h1 {
        font-size: 2.5rem;
        margin-bottom: 12px;
        font-weight: 600;
        letter-spacing: -0.02em;
        color: var(--text-primary);
        line-height: 1.2;
      }

      .subtitle {
        font-size: 1.1rem;
        color: var(--text-secondary);
        font-weight: 400;
        max-width: 600px;
        line-height: 1.6;
      }

      section {
        padding: 30px 40px;
        border-bottom: none;
        margin-bottom: 20px;
      }

      h2 {
        font-size: 1.75rem;
        margin-bottom: 36px;
        color: var(--text-marron);
        font-weight: 700;
        letter-spacing: -0.02em;
        text-align: left;
        position: relative;
        padding-bottom: 12px;
      }

      h2::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 60px;
        height: 4px;
        background: var(--header-color);
        border-radius: 2px;
      }

      h3 {
        font-size: 1.3rem;
        margin-bottom: 20px;
        color: var(--text-primary);
        font-weight: 600;
        letter-spacing: -0.01em;
      }

      h4 {
        font-size: 1rem;
        margin-bottom: 12px;
        color: var(--text-primary);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-size: 0.85rem;
      }

      p {
        margin-bottom: 16px;
        color: var(--text-secondary);
        line-height: 1.7;
        font-size: 1rem;
      }

      .info-box {
        margin-bottom: 28px;
      }

      .tip-box {
        background: #eff6ff;
        border-left: 4px solid var(--primary-color);
        border-radius: var(--border-radius);
        padding: 20px;
      }

      .note-box {
        background: #ffffff;
      }

      .exception-box {
        background: #f4f7fa;
        border-left: 4px solid #ef4444;
        border-radius: var(--border-radius);
        padding: 20px;
      }

      .highlight {
        background: #fef3c7;
        padding: 12px 16px;
        font-weight: 500;
        border-radius: 12px;
        display: inline-block;
        box-shadow: var(--shadow-sm);
        border: 1px solid #fbbf24;
      }

      ul {
        margin-left: 24px;
        margin-bottom: 20px;
      }

      li {
        margin-bottom: 10px;
        color: var(--text-secondary);
      }

      .table-responsive {
        overflow-x: auto;
        margin: 32px 0;
        -ms-overflow-style: none;
        scrollbar-width: none;
        border-radius: 15px;
      }

      .table-responsive::-webkit-scrollbar {
        display: none;
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        background: var(--bg-card);
        border: none;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: var(--shadow-md);
      }

      thead {
        background: hsl(39, 100%, 73%);
        border-bottom: none;
      }

      thead tr:first-child th:first-child {
        border-top-left-radius: 12px;
      }

      thead tr:first-child th:last-child {
        border-top-right-radius: 12px;
      }

      tbody tr:last-child td:first-child {
        border-bottom-left-radius: 12px;
      }

      tbody tr:last-child td:last-child {
        border-bottom-right-radius: 12px;
      }

      td {
        padding: 20px 24px;
        border-bottom: 1px solid var(--border-color);
        border-right: 1px solid var(--border-color);
        color: var(--text-secondary);
        font-size: 1rem;
        vertical-align: middle;
        text-align: center;
        position: relative;
      }

      td:last-child {
        border-right: none;
      }

      /* Arrow pointing to next column */
      tbody tr td:not(:last-child)::after {
        content: "â†’";
        position: absolute;
        right: -16px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2.5rem;
        color: #d4a574;
        font-weight: 600;
        z-index: 1;
        opacity: 0.8;
      }

      th {
        padding: 20px 24px;
        text-align: center;
        font-weight: 600;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-primary);
        border-right: 1px solid rgba(255, 255, 255, 0.3);
      }

      th:last-child {
        border-right: none;
      }

      .audio-cell {
        width: 40px;
        padding: 8px;
        text-align: center;
      }

      .french-word {
        display: inline-block;
        min-width: 120px;
      }

      tbody tr:nth-child(odd) {
        background: #fffbeb;
      }

      tbody tr:nth-child(even) {
        background: white;
      }

      tbody tr:last-child td {
        border-bottom: none;
      }

      .audio-btn {
        border: none;
        width: 32px;
        height: 32px;
        border-radius: 0;
        cursor: pointer;

        transition: all 0.2s ease;
        font-size: 0.85rem;
        margin: 2px;
      }

      .audio-btn:first-child {
        margin-left: 0;
      }

      td:has(.audio-btn) {
        white-space: nowrap;
      }

      .audio-btn:active {
        transform: scale(0.95);
      }

      .audio-btn i {
        pointer-events: none;
      }

      .audio-btn-inline {
        background: transparent;
        color: #e0afc7;
        border: none;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 0.9rem;
        vertical-align: middle;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .audio-btn-inline:hover {
        color: #db2777;
        transform: scale(1.15);
      }

      .audio-btn-inline:active {
        transform: scale(0.95);
      }

      .audio-btn-inline i {
        pointer-events: none;
      }

      td {
        display: table-cell;
        vertical-align: middle;
      }

      .rules-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 16px;
        margin: 32px 0;
      }

      .rule-btn {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        padding: 24px 16px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 12px;
        font-family: inherit;
      }

      .rule-btn:hover {
        border-color: var(--primary-color);
        background: var(--bg-secondary);
      }

      .rule-number {
        width: 40px;
        height: 40px;
        background: var(--primary-color);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        font-weight: 600;
      }

      .rule-title {
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--text-secondary);
        text-align: center;
        line-height: 1.4;
      }

      .rule-section {
        display: block;
        padding: 40px 40px;
        border-bottom: 1px solid var(--border-color);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }

        to {
          opacity: 1;
        }
      }

      .rule-card {
        background: var(--bg-card);
        padding: 32px;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-md);
        border: 1px solid var(--border-color);
      }

      .rule-badge {
        background: var(--text-primary);
        color: white;
        padding: 8px 20px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        margin-right: 12px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        display: inline-block;
      }

      .rule-description {
        font-size: 1rem;
        color: var(--text-secondary);
        margin-bottom: 24px;
        font-weight: 400;
      }

      .next-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 16px 40px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        margin-top: 40px;
        font-family: inherit;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(37, 99, 235, 0.3);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .next-btn:hover {
        background: var(--accent-color);
      }

      .next-btn:active {
        transform: translateY(1px);
      }

      .examples-section {
        background: var(--bg-primary);
      }

      .agreement-section {
        background: var(--bg-primary);
      }

      .note-text {
        font-style: normal;
        color: var(--text-secondary);
        margin-top: 24px;
        padding: 20px;

        border-radius: 20px;
        font-size: 0.9rem;
        border: 2px solid var(--border-color);
      }

      footer {
        background: var(--text-primary);
        color: white;
        text-align: center;
        padding: 60px 40px;
        font-size: 0.9rem;
        border-top: none;
      }

      footer p {
        margin: 0;
        color: white;
        font-weight: 400;
        letter-spacing: 0.05em;
      }

      /* Listening Practice Section */
      .listening-section {
        padding: 60px 40px 80px;
        background: var(--bg-primary);
      }

      .listening-card {
        max-width: 1200px;
        margin: 0 auto;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        overflow: hidden;
        display: grid;
        grid-template-columns: 1fr 280px;
        gap: 0;
        box-shadow: var(--shadow-md);
      }

      .listening-content {
        padding: 40px 20px;
      }

      .audio-header {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 0;
        background: transparent;
        border: none;
        border-radius: 0;
        margin-bottom: 24px;
      }

      .main-play-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--text-primary);
        border: none;
        color: white;
        font-size: 0.95rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }

      .main-play-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 16px rgba(61, 40, 23, 0.18);
      }

      .audio-info {
        display: flex;
        align-items: center;
        gap: 16px;
        flex: 1;
      }

      .speed-selector {
        font-family: "DM Sans", sans-serif;
        font-size: 0.85rem;
        color: var(--text-secondary);
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid #e8dfd6;
        border-radius: 8px;
        padding: 6px 12px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s ease;
        outline: none;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23927a63' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 8px center;
        background-size: 16px;
        padding-right: 32px;
      }

      .speed-selector:hover {
        background-color: white;
        border-color: #d4a574;
      }

      .speed-selector:focus {
        border-color: var(--text-primary);
        box-shadow: 0 0 0 2px rgba(61, 40, 23, 0.1);
      }

      .speed-selector option {
        font-family: "DM Sans", sans-serif;
        font-size: 0.9rem;
        color: var(--text-primary);
        background: white;
        padding: 8px 12px;
        font-weight: 500;
      }

      .speed-selector option:hover {
        background: #fdf8f3;
      }

      .speed-selector option:checked {
        background: linear-gradient(135deg, #fef3c7, #fde68a);
        color: var(--text-primary);
        font-weight: 600;
      }

      .speed-display {
        font-size: 0.85rem;
        color: var(--text-secondary);
        font-weight: 500;
        min-width: 40px;
      }

      .rewind-btn {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: transparent;
        border: 2px solid var(--text-primary);
        color: var(--text-primary);
        font-size: 0.85rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }

      .rewind-btn:hover {
        background: var(--text-primary);
        color: white;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(61, 40, 23, 0.15);
      }

      .rewind-btn:active {
        transform: translateY(0) scale(0.95);
      }

      .progress-bar {
        flex: 1;
        height: 6px;
        background: #e9e4dc;
        border-radius: 999px;
        overflow: hidden;
        position: relative;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #d4a574, #b8956a);
        width: 0%;
        border-radius: 999px;
        transition: width 0.5s ease-out;
      }

      .refresh-btn {
        display: none;
      }

      .story-title {
        color: var(--text-marron);
        font-size: 1.6rem;
        margin-bottom: 20px;
        font-weight: 600;
      }

      .story-text-box {
        background: transparent;

        border-radius: 0;
      }

      .story-sentence {
        margin-bottom: 20px;
        line-height: 1.7;
        border-radius: 8px;
        transition: all 0.3s ease;
        position: relative;
        cursor: help;
        max-width: 800px;
      }

      .story-sentence::after {
        content: attr(data-translation);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%) translateY(-8px);
        background: rgba(50, 47, 44, 0.95);
        color: #fff;
        padding: 12px 16px;
        border-radius: 8px;
        font-size: 0.9rem;
        white-space: normal;
        max-width: 500px;
        width: max-content;
        opacity: 0;
        pointer-events: none;
        transition:
          opacity 0.3s ease,
          transform 0.3s ease;
        z-index: 100;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        line-height: 1.5;
        text-align: center;
        font-weight: 400;
      }

      .story-sentence:hover::after {
        opacity: 1;
        transform: translateX(-50%) translateY(-12px);
      }

      .story-sentence:hover {
        background: linear-gradient(
          to right,
          rgba(255, 251, 235, 0.8),
          rgba(254, 243, 199, 0.6)
        );
        border-left: 3px solid #f59e0b;
        padding-left: 25px;
      }

      .story-sentence.active {
        background: linear-gradient(
          to right,
          rgba(236, 254, 255, 0.9),
          rgba(207, 250, 254, 0.7)
        );
        border-left: 4px solid #06b6d4;
        padding-left: 28px;
        box-shadow: 0 3px 15px rgba(6, 182, 212, 0.25);
      }

      .story-sentence.active .french-sentence {
        color: #0e7490;
        opacity: 100%;
      }

      .story-sentence:last-child {
        margin-bottom: 0;
      }

      .french-sentence {
        color: var(--text-secondary);
        font-weight: 600;
        display: block;
        opacity: 80%;
        margin-bottom: 6px;
        font-size: 1rem;
        padding: 10px;
      }

      .french-sentence .word {
        display: inline-block;
        margin-right: 2px;
        position: relative;
      }

      .french-sentence .letter {
        padding: 0 1px;
        border-radius: 3px;
        transition:
          background-color 0.2s ease,
          color 0.2s ease;
      }

      .french-sentence .letter-active {
        background: #fdecc8;
        color: var(--text-secondary);
      }

      .story-text-box .translation {
        display: none;
      }

      .listening-image {
        position: relative;
        overflow: hidden;
        padding: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .listening-image img {
        width: 100%;
        height: auto;
        max-height: 350px;
        object-fit: cover;
        object-position: center;
        display: block;
        border-radius: 12px;
        box-shadow:
          0 10px 30px rgba(0, 0, 0, 0.2),
          0 5px 15px rgba(0, 0, 0, 0.15);
        animation: floatImage 3s ease-in-out infinite;
        transition:
          transform 0.3s ease,
          box-shadow 0.3s ease;
      }

      .listening-image img:hover {
        transform: scale(1.05);
        box-shadow:
          0 15px 40px rgba(0, 0, 0, 0.3),
          0 8px 20px rgba(0, 0, 0, 0.2);
        animation-play-state: paused;
      }

      @keyframes floatImage {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        25% {
          transform: translateY(-8px) rotate(1deg);
        }
        50% {
          transform: translateY(-12px) rotate(0deg);
        }
        75% {
          transform: translateY(-8px) rotate(-1deg);
        }
      }

      .listening-controls {
        display: none;
      }

      /* Dark mode styles for listening section */
      body.dark-mode .listening-card {
        background: #2d2520;
        border-color: #6b5a47;
      }

      body.dark-mode .audio-header {
        background: #3a302a;
        border-color: #6b5a47;
      }

      body.dark-mode .progress-bar {
        background: #4a3f38;
      }

      body.dark-mode .story-title {
        color: #d4a574;
      }

      body.dark-mode .speed-display,
      body.dark-mode .refresh-btn {
        color: #d4a574;
      }

      /* Responsive Design */
      @media (max-width: 968px) {
        body {
          display: block;
        }

        .toc-sidebar {
          transform: translateX(-100%);
          transition: transform 0.3s ease;
          box-shadow: 4px 0 12px rgba(0, 0, 0, 0.1);
        }

        .toc-sidebar.open {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
          width: 100%;
        }

        .container {
          padding: 0 24px;
        }

        header {
          padding: 60px 24px 40px;
        }

        header h1 {
          font-size: 2rem;
        }

        section {
          padding: 40px 24px;
        }

        h2 {
          font-size: 1.5rem;
        }

        .rules-grid {
          grid-template-columns: 1fr;
          gap: 8px;
        }

        .rule-section {
          padding: 40px 24px;
        }

        table {
          font-size: 0.9rem;
        }

        th,
        td {
          padding: 12px 8px;
        }

        .listening-section {
          padding: 40px 24px;
        }

        .listening-card {
          grid-template-columns: 1fr;
        }

        .listening-content {
          padding: 32px 24px;
        }

        .listening-image {
          height: 250px;
          border-left: none;
          border-top: 3px solid #d4a574;
        }

        .audio-header {
          padding: 12px 16px;
        }

        .main-play-btn {
          width: 40px;
          height: 40px;
          font-size: 1rem;
        }

        .story-title {
          font-size: 1.4rem;
        }

        .sidebar-section.build-topics a {
          font-size: 0.75rem;
          padding: 8px 10px;
        }
      }

      @media (max-width: 480px) {
        .toc-sidebar {
          width: 100%;
        }

        header {
          padding: 40px 20px 30px;
        }

        header h1 {
          font-size: 1.75rem;
        }

        .subtitle {
          font-size: 1rem;
        }

        section {
          padding: 32px 20px;
        }

        .rule-section {
          padding: 32px 20px;
        }

        table {
          font-size: 0.85rem;
        }

        th,
        td {
          padding: 10px 6px;
          font-size: 0.8rem;
        }
      }

      /* Additional Styles */
      strong {
        font-weight: 600;
        color: var(--text-primary);
      }

      em {
        font-style: italic;
        color: var(--text-secondary);
      }

      /* Print Styles */
      @media print {
        body {
          background: white;
          padding: 0;
        }

        .container {
          box-shadow: none;
        }

        .rule-btn {
          page-break-inside: avoid;
        }

        .rule-section {
          display: block !important;
          page-break-before: always;
        }
      }

      /* Smooth transitions */
      a {
        color: var(--accent-color);
        text-decoration: none;
        transition: color 0.2s ease;
      }

      a:hover {
        color: var(--primary-color);
      }

      button {
        outline: none;
      }

      button:focus {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }

      /* Active rule button state */
      .rule-btn.active {
        background: var(--primary-color);
        border-color: var(--primary-color);
      }

      .rule-btn.active .rule-number {
        background: white;
        color: var(--primary-color);
      }

      .rule-btn.active .rule-title {
        color: white;
      }

      /* French text with translation tooltips */
      .french-text {
        position: relative;
        cursor: help;
        border-bottom: none;
        transition: all 0.2s ease;
      }

      .french-text:hover {
        color: var(--primary-color);
      }

      .tooltip {
        visibility: hidden;
        opacity: 0;
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%) translateY(-5px);
        background: var(--text-primary);
        color: white;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.85rem;
        white-space: nowrap;
        z-index: 1000;
        pointer-events: none;
        transition: all 0.2s ease;
        font-weight: 500;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        border: 6px solid transparent;
        border-top-color: var(--text-primary);
      }

      .french-text:hover .tooltip {
        visibility: visible;
        opacity: 1;
        transform: translateX(-50%) translateY(-8px);
      }

      /* Theme Toggle Button */
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: transparent;
        color: var(--text-primary);
        border: 2px solid var(--text-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        transition: all 0.2s ease;
        z-index: 9999;
      }

      .theme-toggle:hover {
        background: var(--text-primary);
        color: white;
        border-color: var(--text-primary);
      }

      .theme-toggle:active {
        transform: scale(0.95);
      }

      /* Mobile Menu Toggle Button */
      .menu-toggle {
        position: fixed;
        left: -10px;
        top: 5px;
        width: 56px;
        height: 56px;

        color: #8b5a3c;

        cursor: pointer;
        display: none;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        z-index: 1001;
        border: none;
        background: transparent;
        outline: none;
      }

      .menu-toggle:hover {
        color: #6b4a33;
      }

      .menu-toggle:active {
        transform: scale(0.95);

        outline: none;
      }

      .menu-toggle:focus {
        outline: none;
      }

      @media (max-width: 968px) {
        .menu-toggle {
          display: flex;
        }
      }
      option {
        border-radius: 5px;
      }

      /* Light Mode Theme */
      body.light-mode {
        --bg-primary: #ffffff;
        --bg-secondary: #f3f4f6;
      }

      body.light-mode .theme-toggle {
        border: none;
      }

      body.light-mode .theme-toggle:hover {
        border: none;
      }

      /* Light mode sidebar */
      body.light-mode .toc-sidebar {
        background: #f9fafb;
        border-right-color: #e5e7eb;
        box-shadow: 2px 0 8px rgba(0, 0, 0, 0.05);
      }

      body.light-mode .toc-title {
        color: #6b7280;
      }

      body.light-mode .toc-list a {
        color: #4b5563;
      }

      body.light-mode .toc-list a:hover {
        background: #e5e7eb;
        color: #1f2937;
      }

      body.light-mode .toc-list a.active {
        background: #dbeafe;
        color: #1e40af;
      }

      /* Dark Mode Theme */
      body.dark-mode {
        --bg-primary: #1a1a1a;
        --bg-secondary: #2d2d2d;
        --text-primary: #e5e5e5;
        --text-secondary: #b0b0b0;
        --border-color: #404040;
        --hover-bg: #2d2d2d;
      }

      body.dark-mode section {
        background-color: #1a1a1a;
      }

      body.dark-mode .theme-toggle {
        border: 1px solid var(--text-secondary);
      }

      body.dark-mode .theme-toggle:hover {
        background: var(--text-primary);
        color: #1a1a1a;
        border-color: var(--text-primary);
      }

      body.dark-mode table {
        background: #2d2d2d;
      }

      body.dark-mode th {
        background-color: #3a3a3a !important;
      }

      body.dark-mode tr:nth-child(even) {
        background-color: #252525 !important;
      }

      body.dark-mode tr:nth-child(odd) {
        background-color: #2d2d2d !important;
      }

      body.dark-mode .tip-box,
      body.dark-mode .note-box,
      body.dark-mode .exception-box {
        background-color: #2a2a3a;
        border-left-color: #4a90e2;
      }

      body.dark-mode .highlight-section {
        background-color: #252525;
      }

      /* Dark mode sidebar */
      body.dark-mode .toc-sidebar {
        background: #1f1f1f;
        border-right-color: #333;
        box-shadow: 2px 0 8px rgba(0, 0, 0, 0.3);
      }

      body.dark-mode .toc-title {
        color: #9ca3af;
      }

      body.dark-mode .toc-list a {
        color: #9ca3af;
      }

      body.dark-mode .toc-list a:hover {
        background: #2d2d2d;
        color: #60a5fa;
      }

      body.dark-mode .toc-list a.active {
        background: #1e3a8a;
        color: #93c5fd;
      }
    </style>
  </head>

  <body>
    <!-- Mobile Menu Toggle -->
    <button class="menu-toggle" id="menuToggle" title="Toggle navigation">
      <i class="fas fa-list-ul"></i>
    </button>

    <!-- Table of Contents Sidebar -->
    <aside class="toc-sidebar" id="tocSidebar">
      <h2 class="toc-title">Table of Contents</h2>
      <ul class="toc-list">
        <li>
          <a href="#intro"><i class="fas fa-home"></i> Introduction</a>
        </li>
        <li>
          <a href="#quick-examples"
            ><i class="fas fa-lightbulb"></i> Quick Examples</a
          >
        </li>
        <li>
          <a href="#rule-1"><i class="fas fa-bookmark"></i> Rule 1: Add -s</a>
        </li>
        <li>
          <a href="#rule-2"
            ><i class="fas fa-bookmark"></i> Rule 2: -s, -x, -z stay same</a
          >
        </li>
        <li>
          <a href="#rule-3"
            ><i class="fas fa-bookmark"></i> Rule 3: -eau, -au, -eu + x</a
          >
        </li>
        <li>
          <a href="#rule-4"
            ><i class="fas fa-bookmark"></i> Rule 4: -al â†’ -aux</a
          >
        </li>
        <li>
          <a href="#rule-5"
            ><i class="fas fa-bookmark"></i> Rule 5: Irregular plurals</a
          >
        </li>
        <li>
          <a href="#listening-practice"
            ><i class="fas fa-headphones"></i> Listening Practice</a
          >
        </li>
      </ul>

      <!-- Additional Sidebar Content -->
      <div class="sidebar-section" style="margin-top: 32px">
        <h3
          style="
            font-size: 0.85rem;
            font-weight: 700;
            color: #374151;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding-left: 12px;
          "
        >
          <i class="fas fa-lightbulb"></i> Quick Tips
        </h3>
        <ul style="list-style: none; padding: 0; margin: 0">
          <li
            style="
              font-size: 0.875rem;
              color: var(--text-secondary);
              padding: 8px 12px;
              margin-bottom: 6px;
              background: rgba(255, 255, 255, 0.5);
              border-radius: 6px;
              border-left: 3px solid #fbbf24;
            "
          >
            Most plurals just add -s
          </li>
          <li
            style="
              font-size: 0.875rem;
              color: var(--text-secondary);
              padding: 8px 12px;
              margin-bottom: 6px;
              background: rgba(255, 255, 255, 0.5);
              border-radius: 6px;
              border-left: 3px solid #fbbf24;
            "
          >
            Plural is often silent
          </li>
          <li
            style="
              font-size: 0.875rem;
              color: var(--text-secondary);
              padding: 8px 12px;
              margin-bottom: 6px;
              background: rgba(255, 255, 255, 0.5);
              border-radius: 6px;
              border-left: 3px solid #fbbf24;
            "
          >
            Watch special endings
          </li>
        </ul>
      </div>

      <div class="sidebar-section" style="margin-top: 24px">
        <h3
          style="
            font-size: 0.85rem;
            font-weight: 700;
            color: #374151;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding-left: 12px;
          "
        >
          <i class="fas fa-exclamation-circle"></i> Remember
        </h3>
        <p
          style="
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
            padding: 8px 12px;
            background: rgba(254, 243, 199, 0.5);
            border-radius: 6px;
            margin: 0;
          "
        >
          Words ending in -s, -x, -z don't change!
        </p>
      </div>

      <div class="sidebar-section build-topics">
        <h3><i class="fas fa-layer-group"></i> Build on this topic</h3>
        <ul>
          <li>
            <a href="#">
              <span
                >Compliments in French: Essential phrases for every
                situation</span
              >
              <i class="fas fa-chevron-right"></i>
            </a>
          </li>
          <li>
            <a href="#">
              <span
                >How to say sorry in French: Complete guide for every
                situation</span
              >
              <i class="fas fa-chevron-right"></i>
            </a>
          </li>
          <li>
            <a href="#">
              <span
                >Directions in French: A comprehensive vocabulary guide</span
              >
              <i class="fas fa-chevron-right"></i>
            </a>
          </li>
          <li>
            <a href="#">
              <span
                >French travel phrases: 40 essential expressions for your 2026
                vacation</span
              >
              <i class="fas fa-chevron-right"></i>
            </a>
          </li>
          <li>
            <a href="#">
              <span
                >Grocery shopping in French: Essential phrases for every
                aisle</span
              >
              <i class="fas fa-chevron-right"></i>
            </a>
          </li>
        </ul>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <button class="theme-toggle" id="themeToggle" title="Toggle reading mode">
        <i class="fa-solid fa-moon"></i>
      </button>
      <div class="container">
        <header>
          <h1>ðŸ‡«ðŸ‡· French Plurals (Pluriels)</h1>
          <p class="subtitle">Master the art of making French nouns plural</p>
        </header>

        <section id="intro" class="intro-section">
          <div class="info-box">
            <h2>Introduction</h2>
            <p>
              In English, making plurals is usually very simple. Most of the
              time, you just add an -s, like <em>cat</em> becoming
              <em>cats</em>.
            </p>
            <p>
              In French, most nouns also form the plural by adding an -s, but
              there are a few important things to notice. The pronunciation
              often does not change. For example, <strong>chat</strong> and
              <strong>chats</strong> sound the same. This means you often
              <em>see</em> the plural more than you <em>hear</em> it.
            </p>
            <p>
              You also need to remember to change the article when a noun
              becomes plural:
            </p>
            <ul>
              <li>
                <strong>un chat</strong>
                <strong>des chats</strong>
              </li>
              <li>
                <strong>la table</strong>
                <strong>les tables</strong>
              </li>
            </ul>
            <p class="highlight">
              So, in French, plural forms are mostly about spelling and using
              the correct article, not always about how the word sounds. Paying
              attention to these small letters is very important in French.
            </p>
          </div>
        </section>

        <section id="quick-examples" class="examples-section">
          <h2>Quick Examples</h2>
          <div class="table-responsive">
            <table class="examples-table">
              <thead>
                <tr class="col-header">
                  <th>French Singular</th>
                  <th>French Plural</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <span class="french-word">un chat</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('un chat')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des chats</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des chats')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">une pomme</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('une pomme')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des pommes</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des pommes')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">le livre</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('le livre')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les livres</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les livres')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">la table</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('la table')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les tables</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les tables')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">un cheval</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('un cheval')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">des chevaux</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('des chevaux')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span class="french-word">la maison</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('la maison')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                  <td>
                    <span class="french-word">les maisons</span>
                    <button
                      class="audio-btn-inline"
                      onclick="speakFrench('les maisons')"
                      title="Play audio"
                    >
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <div id="rule-1" class="rule-section active">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 1</span> Most nouns form the plural
              by adding "-s"
            </h3>
            <p class="rule-description">
              Just add <strong>â€“s</strong> to the end of the word.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>French Singular</th>
                    <th>French Plural</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">un chat</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('un chat')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">des chats</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('des chats')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">une pomme</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('une pomme')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">des pommes</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('des pommes')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">le livre</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('le livre')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">les livres</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('les livres')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">la table</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('la table')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">les tables</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('les tables')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>ðŸ’¡ Key Points</h4>
              <p>
                See those <strong>"les"</strong> and
                <strong>"des"</strong> popping up everywhere? It's simple. When
                a noun becomes plural, <em>le</em> and <em>la</em> change to
                <strong>les</strong>, and <em>un</em> and <em>une</em> become
                <strong>des</strong>. That's all there is to it.
              </p>
              <p>
                Your definite and indefinite articles have simply become plural.
              </p>
            </div>

            <div class="info-box note-box">
              <h4>ðŸ“ Note: Liaison</h4>
              <p>
                The final <strong>-s</strong> in plural nouns is usually silent
                when speaking. However, when a plural word ending in a silent -s
                is followed by a word that begins with a vowel (a, e, i, o, u,
                y) or a silent "h", a sound link can happen. This is called
                <strong>liaison</strong>.
              </p>
              <p>
                In liaison, the silent -s is pronounced like a
                <strong>z</strong> sound to connect the words smoothly.
              </p>
              <ul>
                <li>
                  <strong>Les</strong> = "lay" â†’ with liaison: "lay-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Les amis')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
                <li>
                  <strong>Mes</strong> = "may" â†’ with liaison: "may-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Mes enfants')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
                <li>
                  <strong>Des</strong> = "day" â†’ with liaison: "day-z"
                  <button
                    class="audio-btn-inline"
                    onclick="speakFrench('Des idÃ©es')"
                    title="Play audio"
                  >
                    <i class="fas fa-volume-up"></i>
                  </button>
                </li>
              </ul>

              <div class="table-responsive">
                <table class="liaison-table">
                  <thead>
                    <tr>
                      <th>Singular Form</th>
                      <th>Plural Phrase (with liaison)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>L'ami</td>
                      <td>
                        <span class="french-word">Les amis</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les amis')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Mon enfant</td>
                      <td>
                        <span class="french-word">Mes enfants</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Mes enfants')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Une idÃ©e</td>
                      <td>
                        <span class="french-word">Des idÃ©es</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Des idÃ©es')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Le village</td>
                      <td>
                        <span class="french-word">Les villages</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les villages')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <td>Le chapeau</td>
                      <td>
                        <span class="french-word">Les chapeaux</span>
                        <button
                          class="audio-btn-inline"
                          onclick="speakFrench('Les chapeaux')"
                          title="Play audio"
                        >
                          <i class="fas fa-volume-up"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div id="rule-2" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 2</span> Nouns ending in -s, -x, or
              -z stay the same
            </h3>
            <p class="rule-description">
              No change in spelling; they already look plural.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un choix</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un choix')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des choix</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des choix')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un nez</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un nez')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des nez</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des nez')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un fils</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un fils')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des fils</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des fils')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>ðŸ’¡ Remember</h4>
              <p>
                Only the article shows the plural form. The noun itself remains
                unchanged!
              </p>
            </div>
          </div>
        </div>

        <div id="rule-3" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 3</span> Nouns ending in -eau, -au,
              or -eu add "x"
            </h3>
            <p class="rule-description">
              Add <strong>â€“x</strong> instead of â€“s.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un tableau</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un tableau')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des tableaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des tableaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un gÃ¢teau</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un gÃ¢teau')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des gÃ¢teaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des gÃ¢teaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un jeu</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un jeu')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des jeux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des jeux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box exception-box">
              <h4>âš ï¸ Exceptions</h4>
              <p>Some nouns just add -s instead:</p>
              <ul>
                <li><strong>bleu</strong> â†’ <strong>bleus</strong></li>
                <li><strong>pneu</strong> â†’ <strong>pneus</strong></li>
              </ul>
            </div>
          </div>
        </div>

        <div id="rule-4" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 4</span> Nouns ending in -al change
              to -aux
            </h3>
            <p class="rule-description">
              Replace <strong>-al</strong> with <strong>-aux</strong>.
            </p>

            <div class="table-responsive">
              <table class="rule-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un animal</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un animal')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des animaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des animaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un journal</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un journal')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>
                      <span class="french-word">Des journaux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des journaux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box exception-box">
              <h4>âš ï¸ Exceptions</h4>
              <p>Some nouns just add -s:</p>
              <ul>
                <li>
                  <strong>un festival</strong> â†’ <strong>des festivals</strong>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div id="rule-5" class="rule-section">
          <div class="rule-card">
            <h3>
              <span class="rule-badge">Rule 5</span> Seven nouns ending in -ou
              change to -oux
            </h3>
            <p class="rule-description">
              Most other -ou nouns just take a regular -s in plural. These are
              the
              <strong>7 exceptions</strong> in French where -ou becomes -oux in
              the plural.
            </p>

            <div class="table-responsive">
              <table class="rule-table special-table">
                <thead>
                  <tr>
                    <th>Singular Phrase</th>
                    <th>Meaning</th>
                    <th>Plural Form</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="french-word">Un bijou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un bijou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a jewel / jewellery</td>
                    <td>
                      <span class="french-word">Des bijoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des bijoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un caillou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un caillou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a pebble</td>
                    <td>
                      <span class="french-word">Des cailloux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des cailloux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un chou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un chou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a cabbage</td>
                    <td>
                      <span class="french-word">Des choux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des choux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un genou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un genou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a knee</td>
                    <td>
                      <span class="french-word">Des genoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des genoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un hibou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un hibou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>an owl</td>
                    <td>
                      <span class="french-word">Des hiboux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des hiboux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un joujou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un joujou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a toy</td>
                    <td>
                      <span class="french-word">Des joujoux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des joujoux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <span class="french-word">Un pou</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Un pou')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                    <td>a louse</td>
                    <td>
                      <span class="french-word">Des poux</span>
                      <button
                        class="audio-btn-inline"
                        onclick="speakFrench('Des poux')"
                        title="Play audio"
                      >
                        <i class="fas fa-volume-up"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="info-box tip-box">
              <h4>ðŸ’¡ Memory Tip</h4>
              <p>
                Remember these 7 special words! All other -ou words just add a
                regular -s.
              </p>
            </div>
          </div>
        </div>

        <section class="summary-section">
          <h2>Summary of All Rules</h2>
          <div class="table-responsive">
            <table class="summary-table">
              <thead>
                <tr>
                  <th>Rule</th>
                  <th>Main Idea</th>
                  <th>Examples</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Rule 1</strong></td>
                  <td>Most nouns form the plural by adding -s</td>
                  <td>chat â†’ chats<br />pomme â†’ pommes<br />livre â†’ livres</td>
                  <td>
                    The final -s is silent. Articles change to <em>les</em> and
                    <em>des</em>. Liaison appears before vowels.
                  </td>
                </tr>
                <tr>
                  <td><strong>Rule 2</strong></td>
                  <td>Nouns ending in -s, -x, or -z do not change</td>
                  <td>choix â†’ choix<br />nez â†’ nez<br />fils â†’ fils</td>
                  <td>Only the article shows the plural form.</td>
                </tr>
                <tr>
                  <td><strong>Rule 3</strong></td>
                  <td>Nouns ending in -eau, -au, or -eu add -x</td>
                  <td>
                    tableau â†’ tableaux<br />gÃ¢teau â†’ gÃ¢teaux<br />jeu â†’ jeux
                  </td>
                  <td>The -x is silent. A few exceptions add -s.</td>
                </tr>
                <tr>
                  <td><strong>Rule 4</strong></td>
                  <td>Nouns ending in -al change to -aux</td>
                  <td>animal â†’ animaux<br />journal â†’ journaux</td>
                  <td>Some exceptions add -s, such as festival â†’ festivals.</td>
                </tr>
                <tr>
                  <td><strong>Rule 5</strong></td>
                  <td>Seven nouns ending in -ou change to -oux</td>
                  <td>bijou â†’ bijoux<br />chou â†’ choux<br />genou â†’ genoux</td>
                  <td>Most other -ou nouns take a regular -s.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="agreement-section">
          <div class="info-box">
            <h2>What Else Changes with Plural Nouns?</h2>
            <p>
              For now, just remember this: in French, when a noun is plural,
              some other words linked to it are usually plural too. These
              include articles (like <em>les</em>), adjectives (like
              <em>grands</em>), verbs (like <em>jouent</em>), demonstratives
              (like <em>ces</em>), and possessives (like <em>mes</em>).
            </p>

            <div class="table-responsive">
              <table class="agreement-table">
                <thead>
                  <tr>
                    <th>Element</th>
                    <th>French</th>
                    <th>English Translation</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Definite article</td>
                    <td>les chats</td>
                    <td>the cats</td>
                  </tr>
                  <tr>
                    <td>Indefinite article</td>
                    <td>des livres</td>
                    <td>(some) books</td>
                  </tr>
                  <tr>
                    <td>Partitive article</td>
                    <td>des fruits</td>
                    <td>(some) fruits</td>
                  </tr>
                  <tr>
                    <td>Adjective</td>
                    <td>grandes maisons</td>
                    <td>big houses</td>
                  </tr>
                  <tr>
                    <td>Verb (subject-verb)</td>
                    <td>les enfants jouent</td>
                    <td>the children are playing</td>
                  </tr>
                  <tr>
                    <td>Demonstrative adjective</td>
                    <td>ces chaises</td>
                    <td>these chairs</td>
                  </tr>
                  <tr>
                    <td>Possessive adjective</td>
                    <td>ses amis</td>
                    <td>his/her friends</td>
                  </tr>
                  <tr>
                    <td>Pronoun (subject or obj)</td>
                    <td>ils parlent, je les vois</td>
                    <td>they are speaking, I see them</td>
                  </tr>
                  <tr>
                    <td>Ã  / de contractions</td>
                    <td>aux filles, des garÃ§ons</td>
                    <td>to the girls, (some) boys</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <p class="note-text">
              You do not need to master all of this right now. You will learn
              these rules step by step as you continue learning French. This
              note is only to keep you informed so you know what is coming
              later.
            </p>
          </div>
        </section>

        <!-- Audio Story Section -->
        <section id="listening-practice" class="listening-section">
          <div class="listening-card">
            <div class="listening-content">
              <div class="audio-header">
                <button class="main-play-btn" id="mainPlayBtn">
                  <i class="fas fa-play"></i>
                </button>
                <div class="audio-info">
                  <select id="speedControl" class="speed-selector">
                    <option value="0.6">0.6x Slow</option>
                    <option value="0.8" selected>0.8x Normal</option>
                    <option value="1.0">1.0x Fast</option>
                  </select>
                  <div class="progress-bar">
                    <div class="progress-fill"></div>
                  </div>
                  <button
                    class="rewind-btn"
                    id="rewindBtn"
                    title="Restart from beginning"
                  >
                    <i class="fas fa-undo"></i>
                  </button>
                </div>
              </div>

              <h3 class="story-title">Deux cafÃ© S'il-vous plaÃ®t</h3>

              <div class="story-text-box" id="storyTextBox">
                <p
                  class="story-sentence"
                  data-index="0"
                  data-translation="This morning, I walk on this calm street and I look around me."
                >
                  <strong class="french-sentence"
                    >Ce matin, je marche dans cette rue calme et je regarde
                    autour de moi.</strong
                  >
                </p>

                <p
                  class="story-sentence"
                  data-index="1"
                  data-translation="Near the cafÃ©, I see this man with a smile and he speaks softly."
                >
                  <strong class="french-sentence"
                    >PrÃ¨s du cafÃ©, je vois cet homme avec un sourire et il parle
                    doucement.</strong
                  >
                </p>

                <p
                  class="story-sentence"
                  data-index="2"
                  data-translation="This man reads this book while he drinks a coffee."
                >
                  <strong class="french-sentence"
                    >Cet homme lit ce livre-ci pendant qu'il boit un
                    cafÃ©.</strong
                  >
                </p>

                <p
                  class="story-sentence"
                  data-index="3"
                  data-translation="A little further, these children play in that park and laugh together."
                >
                  <strong class="french-sentence"
                    >Un peu plus loin, ces enfants jouent dans le parc-lÃ  et
                    rient ensemble.</strong
                  >
                </p>

                <p
                  class="story-sentence"
                  data-index="4"
                  data-translation="This simple scene makes me calm and happy."
                >
                  <strong class="french-sentence"
                    >Cette scÃ¨ne simple me rend calme et heureux.</strong
                  >
                </p>
              </div>

              <div class="listening-controls">
                <button class="play-story-btn" id="playStoryBtn">
                  <i class="fas fa-play"></i> Play Story
                </button>
                <button
                  class="pause-story-btn"
                  id="pauseStoryBtn"
                  style="display: none"
                >
                  <i class="fas fa-pause"></i> Pause
                </button>
                <select id="speedControl" class="speed-selector">
                  <option value="0.6">Slow</option>
                  <option value="0.8" selected>Normal</option>
                  <option value="1.0">Fast</option>
                </select>
              </div>
            </div>

            <div class="listening-image">
              <img
                src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=800&auto=format&fit=crop&q=80"
                alt="Cafe terrace with coffee and food"
              />
            </div>
          </div>
        </section>
      </div>
    </div>
    <!-- End Main Content -->

    <script>
      // Story audio player variables
      let storySentences = [];
      let storyUtterance = null;
      let isPlaying = false;
      let currentSentenceIndex = 0;
      let letterTimer = null;

      // Word translations dictionary
      const wordTranslations = {
        ce: "this",
        matin: "morning",
        je: "I",
        marche: "walk",
        dans: "in",
        cette: "this",
        rue: "street",
        calme: "calm",
        et: "and",
        regarde: "look",
        autour: "around",
        de: "of",
        moi: "me",
        prÃ¨s: "near",
        du: "of the",
        cafÃ©: "cafÃ©",
        vois: "see",
        cet: "this",
        homme: "man",
        avec: "with",
        un: "a",
        sourire: "smile",
        il: "he",
        parle: "speaks",
        doucement: "softly",
        lit: "reads",
        "livre-ci": "book",
        pendant: "while",
        "qu'il": "that he",
        boit: "drinks",
        peu: "little",
        plus: "more",
        loin: "far",
        ces: "these",
        enfants: "children",
        jouent: "play",
        le: "the",
        "parc-lÃ ": "park",
        rient: "laugh",
        ensemble: "together",
        scÃ¨ne: "scene",
        simple: "simple",
        me: "me",
        rend: "makes",
        heureux: "happy",
      };

      function normalizeSentence(text) {
        return text.replace(/\s+/g, " ").trim();
      }

      function getWordTranslation(word) {
        const cleanWord = word.toLowerCase().replace(/[.,!?;:]/g, "");
        return wordTranslations[cleanWord] || "";
      }

      function buildWordLetterSpans(sentenceEl) {
        const rawText = normalizeSentence(sentenceEl.textContent);
        const fragment = document.createDocumentFragment();
        const tokens = rawText.split(/(\s+)/);
        let offset = 0;

        tokens.forEach((token) => {
          if (token === "") {
            return;
          }

          if (/^\s+$/.test(token)) {
            fragment.appendChild(document.createTextNode(token));
            offset += token.length;
            return;
          }

          const wordSpan = document.createElement("span");
          wordSpan.className = "word";
          wordSpan.dataset.start = offset;
          wordSpan.dataset.end = offset + token.length;

          // Add translation to word
          const translation = getWordTranslation(token);
          if (translation) {
            wordSpan.dataset.translation = translation;
          }

          Array.from(token).forEach((char, index) => {
            const letterSpan = document.createElement("span");
            letterSpan.className = "letter";
            letterSpan.textContent = char;
            letterSpan.dataset.index = offset + index;
            wordSpan.appendChild(letterSpan);
          });

          fragment.appendChild(wordSpan);
          offset += token.length;
        });

        sentenceEl.textContent = "";
        sentenceEl.appendChild(fragment);
        sentenceEl.dataset.text = rawText;
      }

      // Highlight sentence
      function highlightSentence(index) {
        // Remove all active classes
        document.querySelectorAll(".story-sentence").forEach((el) => {
          el.classList.remove("active");
        });

        // Add active class to current sentence
        const sentence = document.querySelector(
          `.story-sentence[data-index="${index}"]`,
        );
        if (sentence) {
          sentence.classList.add("active");
          sentence.scrollIntoView({ behavior: "smooth", block: "nearest" });
        }
      }

      // Clear all highlights
      function clearHighlights() {
        document.querySelectorAll(".story-sentence").forEach((el) => {
          el.classList.remove("active");
        });
      }

      function highlightLettersInWord(wordEl, rate) {
        if (!wordEl) {
          return;
        }

        if (letterTimer) {
          clearInterval(letterTimer);
          letterTimer = null;
        }

        const letters = Array.from(wordEl.querySelectorAll(".letter"));
        letters.forEach((letter) => letter.classList.remove("letter-active"));

        if (letters.length === 0) {
          return;
        }

        let index = 0;
        const baseCharsPerSecond = 12;
        const interval = Math.max(40, 1000 / (baseCharsPerSecond * rate));

        // Add word-speaking class when starting
        wordEl.classList.add("word-speaking");
        letters[0].classList.add("letter-active");

        letterTimer = setInterval(() => {
          if (index >= letters.length - 1) {
            clearInterval(letterTimer);
            letterTimer = null;
            // Keep word-speaking class - it will be removed when next word starts
            return;
          }
          index += 1;
          letters[index - 1].classList.remove("letter-active");
          letters[index].classList.add("letter-active");
        }, interval);
      }

      function highlightWordAtIndex(sentenceEl, charIndex, rate) {
        if (!sentenceEl) {
          console.log("No sentence element");
          return;
        }

        const words = Array.from(sentenceEl.querySelectorAll(".word"));
        console.log("Found words:", words.length, "charIndex:", charIndex);

        // Remove all previous word highlighting
        words.forEach((word) => {
          word.classList.remove("word-active");
          word.classList.remove("word-speaking");
        });

        const activeWord = words.find((word) => {
          const start = Number(word.dataset.start);
          const end = Number(word.dataset.end);
          return charIndex >= start && charIndex < end;
        });

        if (activeWord) {
          console.log("Highlighting word:", activeWord.textContent);
          activeWord.classList.add("word-active");
          highlightLettersInWord(activeWord, rate);
        } else {
          console.log("No active word found for charIndex:", charIndex);
        }
      }

      // Play story function with highlighting
      function playStory() {
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const speedControl = document.getElementById("speedControl");

        if (isPlaying) {
          // Pause
          window.speechSynthesis.pause();
          isPlaying = false;
          mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        } else if (window.speechSynthesis.paused && storyUtterance) {
          // Resume
          window.speechSynthesis.resume();
          isPlaying = true;
          mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
        } else {
          // Start new - play sentence by sentence
          window.speechSynthesis.cancel();
          currentSentenceIndex = 0;
          playSentence(0);
          isPlaying = true;
          mainPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
        }
      }

      // Play individual sentence with highlighting
      function playSentence(index) {
        if (index >= storySentences.length) {
          // Finished all sentences
          isPlaying = false;
          const mainPlayBtn = document.getElementById("mainPlayBtn");
          if (mainPlayBtn) {
            mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
          }
          clearHighlights();
          updateProgressBar(100);
          return;
        }

        highlightSentence(index);

        // Update progress bar at start of sentence
        const progress = ((index + 1) / storySentences.length) * 100;
        updateProgressBar(progress);

        const sentenceElement = document.querySelector(
          `.story-sentence[data-index="${index}"] .french-sentence`,
        );
        const utterance = new SpeechSynthesisUtterance(storySentences[index]);
        const speedControl = document.getElementById("speedControl");
        const rate = parseFloat(speedControl ? speedControl.value : 0.8);
        utterance.lang = "fr-FR";
        utterance.rate = rate;
        utterance.pitch = 1;
        utterance.volume = 1;

        utterance.onend = function () {
          if (isPlaying) {
            // Play next sentence
            currentSentenceIndex++;
            setTimeout(() => playSentence(currentSentenceIndex), 500);
          }
        };

        window.speechSynthesis.speak(utterance);
      }

      // Update progress bar
      function updateProgressBar(percentage) {
        const progressFill = document.querySelector(".progress-fill");
        if (progressFill) {
          progressFill.style.width = percentage + "%";
        }
      }

      // Refresh/Stop story function
      function refreshStory() {
        window.speechSynthesis.cancel();
        isPlaying = false;
        currentSentenceIndex = 0;
        clearHighlights();
        updateProgressBar(0);
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        if (mainPlayBtn) {
          mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        }
      }

      // Rewind function - restart from beginning
      function rewindStory() {
        window.speechSynthesis.cancel();
        isPlaying = false;
        currentSentenceIndex = 0;
        clearHighlights();
        updateProgressBar(0);
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        if (mainPlayBtn) {
          mainPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
        }
        // Automatically start playing from beginning
        setTimeout(() => {
          playStory();
        }, 100);
      }

      // Theme Toggle Function
      function toggleTheme() {
        const body = document.body;
        const currentTheme = localStorage.getItem("theme") || "warm";

        // Remove all theme classes first
        body.classList.remove("light-mode", "dark-mode");

        // Cycle through themes: warm â†’ light â†’ dark â†’ warm
        if (currentTheme === "warm") {
          body.classList.add("light-mode");
          localStorage.setItem("theme", "light");
        } else if (currentTheme === "light") {
          body.classList.add("dark-mode");
          localStorage.setItem("theme", "dark");
        } else {
          // dark mode, go back to warm
          localStorage.setItem("theme", "warm");
        }
      }

      // Rule navigation function
      function showRule(ruleNumber) {
        // Hide all rule sections
        const allRules = document.uickuerySelectorAll(".rule-section");
        allRules.forEach((rule) => {
          rule.classList.remove("active");
        });

        // Show the selected rule
        const selectedRule = document.getElementById(`rule-${ruleNumber}`);
        if (selectedRule) {
          selectedRule.classList.add("active");
          selectedRule.scrollIntoView({ behavior: "smooth", block: "start" });
        }

        // Update button states
        const allButtons = document.querySelectorAll(".rule-btn");
        allButtons.forEach((btn, index) => {
          if (index + 1 === ruleNumber) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
      }

      // Text-to-Speech function for French words
      function speakFrench(text) {
        // Cancel any ongoing speech
        window.speechSynthesis.cancel();

        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = "fr-FR"; // French language
        utterance.rate = 0.8; // Slightly slower for learning
        utterance.pitch = 1;
        utterance.volume = 1;

        // Try to use a French voice if available
        const voices = window.speechSynthesis.getVoices();
        const frenchVoice = voices.find((voice) => voice.lang.startsWith("fr"));
        if (frenchVoice) {
          utterance.voice = frenchVoice;
        }

        window.speechSynthesis.speak(utterance);
      }

      // Load voices (some browsers need this)
      window.speechSynthesis.onvoiceschanged = function () {
        window.speechSynthesis.getVoices();
      };

      // Translation dictionary for French to English
      const translations = {
        "un chat": "a cat",
        "des chats": "cats",
        "une pomme": "an apple",
        "des pommes": "apples",
        "le livre": "the book",
        "les livres": "the books",
        "la table": "the table",
        "les tables": "the tables",
        "un cheval": "a horse",
        "des chevaux": "horses",
        "la maison": "the house",
        "les maisons": "the houses",
        "un choix": "a choice",
        "des choix": "choices",
        "un nez": "a nose",
        "des nez": "noses",
        "un fils": "a son",
        "des fils": "sons",
        "un tableau": "a painting/board",
        "des tableaux": "paintings/boards",
        "un gÃ¢teau": "a cake",
        "des gÃ¢teaux": "cakes",
        "un jeu": "a game",
        "des jeux": "games",
        "un animal": "an animal",
        "des animaux": "animals",
        "un journal": "a newspaper",
        "des journaux": "newspapers",
        "un bijou": "a jewel",
        "des bijoux": "jewels",
        "un caillou": "a pebble",
        "des cailloux": "pebbles",
        "un chou": "a cabbage",
        "des choux": "cabbages",
        "un genou": "a knee",
        "des genoux": "knees",
        "un hibou": "an owl",
        "des hiboux": "owls",
        "un joujou": "a toy",
        "des joujoux": "toys",
        "un pou": "a louse",
        "des poux": "lice",
        "les chats": "the cats",
        "des livres": "(some) books",
        "des fruits": "(some) fruits",
        "grandes maisons": "big houses",
        "les enfants jouent": "the children are playing",
        "ces chaises": "these chairs",
        "ses amis": "his/her friends",
        "ils parlent": "they are speaking",
        "je les vois": "I see them",
        "aux filles": "to the girls",
        "des garÃ§ons": "(some) boys",
        "L'ami": "the friend",
        "Les amis": "the friends",
        "Mon enfant": "my child",
        "Mes enfants": "my children",
        "Une idÃ©e": "an idea",
        "Des idÃ©es": "(some) ideas",
        "Le village": "the village",
        "Les villages": "the villages",
        "Le chapeau": "the hat",
        "Les chapeaux": "the hats",
        "un festival": "a festival",
        "des festivals": "festivals",
        bleu: "blue",
        bleus: "blues",
        pneu: "tire",
        pneus: "tires",
      };

      // Initialize: Show the first rule by default

      // Add keyboard navigation

      // Add hover effects to table rows

      // Function to update progress bar (optional enhancement)
      function updateProgressBar(percentage) {
        // This can be used to add a progress indicator at the top of the page
        // For now, it's a placeholder for future enhancement
        console.log(`Scroll progress: ${percentage.toFixed(2)}%`);
      }

      // Function to highlight search terms (optional enhancement)
      function highlightText(searchTerm) {
        const content = document.querySelector(".container");
        const innerHTML = content.innerHTML;
        const searchRegex = new RegExp(searchTerm, "gi");

        if (searchTerm.length > 2) {
          const newHTML = innerHTML.replace(
            searchRegex,
            (match) => `<mark>${match}</mark>`,
          );
          content.innerHTML = newHTML;
        }
      }

      // Add print functionality
      function printPage() {
        window.print();
      }

      // Export to PDF functionality (requires additional library in production)
      function exportToPDF() {
        alert(
          "PDF export feature coming soon! For now, you can use your browser's print function to save as PDF.",
        );
        window.print();
      }

      // Toggle dark mode (optional enhancement for future)
      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "darkMode",
          document.body.classList.contains("dark-mode"),
        );
      }

      // Load dark mode preference
      if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
      }

      // Add translation tooltips to French text
      function addTranslationTooltips() {
        // Find all french-word spans first
        const frenchWordSpans = document.querySelectorAll(".french-word");

        frenchWordSpans.forEach((span) => {
          const text = span.textContent.trim();

          // Check if the text exists in our translations (case-insensitive)
          const translationKey = Object.keys(translations).find(
            (key) => key.toLowerCase() === text.toLowerCase(),
          );

          if (translationKey) {
            // Add hover attributes and class
            span.classList.add("french-text");
            span.setAttribute("data-translation", translations[translationKey]);

            // Create tooltip element
            const tooltip = document.createElement("span");
            tooltip.className = "tooltip";
            tooltip.textContent = translations[translationKey];
            span.appendChild(tooltip);
          }
        });

        // Find all table cells (for tables without french-word spans)
        const tableCells = document.querySelectorAll("td");

        tableCells.forEach((cell) => {
          // Skip cells that have audio buttons or already processed french-word spans
          if (
            cell.querySelector(".audio-btn-inline") ||
            cell.querySelector(".french-word")
          ) {
            return;
          }

          const text = cell.textContent.trim();

          // Check if the text exists in our translations (case-insensitive)
          const translationKey = Object.keys(translations).find(
            (key) => key.toLowerCase() === text.toLowerCase(),
          );

          if (translationKey) {
            // Add hover attributes and class
            cell.classList.add("french-text");
            cell.setAttribute("data-translation", translations[translationKey]);

            // Create tooltip element
            const tooltip = document.createElement("span");
            tooltip.className = "tooltip";
            tooltip.textContent = translations[translationKey];
            cell.appendChild(tooltip);
          }
        });

        // Also add to inline French text in paragraphs and lists
        const textElements = document.querySelectorAll("p, li");
        textElements.forEach((element) => {
          let html = element.innerHTML;

          // Look for French text in <strong> or <em> tags
          Object.keys(translations).forEach((french) => {
            const regex = new RegExp(
              `<(strong|em)>\\s*${escapeRegex(french)}\\s*<\/(strong|em)>`,
              "gi",
            );
            const match = html.match(regex);

            if (match) {
              const replacement = `<$1 class="french-text" data-translation="${translations[french]}">${french}<span class="tooltip">${translations[french]}</span></$1>`;
              html = html.replace(regex, replacement);
            }
          });

          element.innerHTML = html;
        });
      }

      // Escape special characters for regex
      function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      }

      // Initialize page on load
      document.addEventListener("DOMContentLoaded", function () {
        // Prepare story text for word-level highlighting
        const storySentenceEls = document.querySelectorAll(
          ".story-sentence .french-sentence",
        );
        storySentences = Array.from(storySentenceEls).map((el) => {
          const normalized = normalizeSentence(el.textContent);
          el.textContent = normalized;
          buildWordLetterSpans(el);
          return normalized;
        });

        // Add translation tooltips
        addTranslationTooltips();

        // Set first rule button as active
        const firstButton = document.querySelector(".rule-btn");
        if (firstButton) {
          firstButton.classList.add("active");
        }

        // Load saved theme
        const savedTheme = localStorage.getItem("theme") || "warm";
        if (savedTheme === "light") {
          document.body.classList.add("light-mode");
        } else if (savedTheme === "dark") {
          document.body.classList.add("dark-mode");
        }

        // Add theme toggle button listener
        const themeToggle = document.getElementById("themeToggle");
        if (themeToggle) {
          themeToggle.addEventListener("click", toggleTheme);
        }

        // Add mobile menu toggle listener
        const menuToggle = document.getElementById("menuToggle");
        const tocSidebar = document.getElementById("tocSidebar");
        if (menuToggle && tocSidebar) {
          menuToggle.addEventListener("click", function () {
            tocSidebar.classList.toggle("open");
          });

          // Close sidebar when clicking outside on mobile
          document.addEventListener("click", function (e) {
            if (
              window.innerWidth <= 968 &&
              !tocSidebar.contains(e.target) &&
              !menuToggle.contains(e.target) &&
              tocSidebar.classList.contains("open")
            ) {
              tocSidebar.classList.remove("open");
            }
          });

          // Close sidebar when clicking a link on mobile
          const tocLinks = tocSidebar.querySelectorAll("a");
          tocLinks.forEach((link) => {
            link.addEventListener("click", function () {
              if (window.innerWidth <= 968) {
                tocSidebar.classList.remove("open");
              }
            });
          });
        }

        // Add story audio player listeners
        const mainPlayBtn = document.getElementById("mainPlayBtn");
        const rewindBtn = document.getElementById("rewindBtn");

        if (mainPlayBtn) {
          mainPlayBtn.addEventListener("click", playStory);
        }

        if (rewindBtn) {
          rewindBtn.addEventListener("click", rewindStory);
        }

        // Update speed when changed
        const speedControl = document.getElementById("speedControl");
        if (speedControl) {
          speedControl.addEventListener("change", function () {
            if (isPlaying) {
              refreshStory();
            }
          });
        }
      });
    </script>
  </body>
</html>
